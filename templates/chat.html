{% extends "layout.html" %}
{% block title %}Czat z AI{% endblock %}
{% block content %}

<h1>🧠 Czat z Wirtualnym Terapeutą</h1>

<div id="chat-container" role="log" aria-live="polite" aria-label="Historia konwersacji">
  {% for wpis in historia %}
    {% if wpis.autor == "AI" %}
      <div class="message-row bot" role="listitem">
        <div class="message bot-message">{{ wpis.wiadomosc }}</div>
      </div>
    {% else %}
      <div class="message-row user" role="listitem">
        <div class="message user-message">{{ wpis.wiadomosc }}</div>
      </div>
    {% endif %}
  {% endfor %}
</div>

<div id="emoji-bar" role="toolbar" aria-label="Emoji">
  <span role="button" aria-label="��">😀</span><span role="button" aria-label="😢">😢</span><span role="button" aria-label="😡">😡</span><span role="button" aria-label="❤️">❤️</span><span role="button" aria-label="🙌">🙌</span>
  <span role="button" aria-label="🤔">🤔</span><span role="button" aria-label="🔥">🔥</span><span role="button" aria-label="💤">💤</span><span role="button" aria-label="😞">😞</span>
</div>

<form id="chat-form" autocomplete="off" role="form" aria-label="Wiadomość">
  <button type="button" id="emoji-toggle" aria-label="Wybierz emoji">😊</button>
  <textarea id="wiadomosc" name="wiadomosc" rows="1" placeholder="Napisz wiadomość..." required></textarea>
  <button type="submit">Wyślij</button>
</form>

<style>
  main { padding-bottom: 110px; }
  #chat-container {
    max-height: 70vh;
    overflow-y: auto;
    padding: 10px;
    width: 100%;
    max-width: 700px;
    margin: 0 auto;
  }
  .message-row { display: flex; margin: 6px 0; }
  .message-row.user { justify-content: flex-end; }
  .message-row.bot { justify-content: flex-start; }
  .message {
    padding: 10px 14px;
    border-radius: 12px;
    max-width: 75%;
    word-wrap: break-word;
    font-size: 15px;
    color: #000;
    background-color: #e6f3ff;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }
  .user-message { background-color: #dcf8c6; text-align: right; }
  .bot-message { background-color: #fff; border: 1px solid #ddd; text-align: left; }
  #emoji-bar {
    display: none;
    position: fixed;
    left: 0; right: 0;
    bottom: 65px;
    justify-content: center;
    gap: 10px;
    padding: 8px;
    font-size: 24px;
    background: #f9f9f9;
    border-top: 1px solid #ddd;
    flex-wrap: wrap;
    max-height
